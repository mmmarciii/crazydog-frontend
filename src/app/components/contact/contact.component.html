<section id="contactus" class="d-flex align-items-center justify-content-center min-vh-100">
  <div class="container">
    @if (!isSent) {
      <div class="row row-cols-1 g-3 mt-4 mt-md-5 px-3 px-md-5 py-4">
        <h1 class="display-3">
          Contact<br>
          <small class="display-5 text-muted">You can reach us</small>
        </h1>
      </div>
    }

    @if (isSent) {
      <div class="row px-5 py-5 justify-content-center animate__animated animate__fadeIn">
        <div class="col-md-8 text-center">
          <div class="mb-4">
            <i class="bi bi-check-circle-fill text-success" style="font-size: 5rem;"></i>
          </div>
          <h2 class="display-4">Thank you!</h2>
          <p class="lead text-muted">Your message has been sent successfully. We will get back to you soon.</p>
          <button class="btn btn-outline-secondary btn-lg mt-4" (click)="isSent = false">
            Send another message
          </button>
        </div>
      </div>
    }

    @if (!isSent) {
      <div class="row px-3 px-md-5 g-3 mb-5">
        <form [formGroup]="contactForm" (ngSubmit)="onSubmit()">
          <div class="form-group px-3 px-md-5 mb-4">
            <input type="text" class="form-control form-control-lg" id="nameInput" 
            placeholder="Name" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Name'" 
            [class.is-invalid]="isFieldInvalid('name')"
            formControlName="name">
            @if (isFieldInvalid('name')) {
              <div class="invalid-feedback d-block">
                {{ getErrorMessage('name') }}
              </div>
            }
          </div>
          <div class="form-group px-3 px-md-5 mb-4">
            <input type="email" class="form-control form-control-lg" id="emailInput" 
            placeholder="Email" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Email'" 
            [class.is-invalid]="isFieldInvalid('email')"
            formControlName="email">
            @if (isFieldInvalid('email')) {
              <div class="invalid-feedback d-block">
                {{ getErrorMessage('email') }}
              </div>
            }
          </div>
          <div class="form-group px-3 px-md-5 mb-4">
            <input type="text" class="form-control form-control-lg" id="subjectInput" 
            placeholder="Subject" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Subject'" 
            [class.is-invalid]="isFieldInvalid('subject')"
            formControlName="subject">
            @if (isFieldInvalid('subject')) {
              <div class="invalid-feedback d-block">
                {{ getErrorMessage('subject') }}
              </div>
            }
          </div>
          <div class="form-group px-3 px-md-5 mb-4">
            <textarea class="form-control form-control-lg" id="textareaInput" rows="5" 
            placeholder="Message" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Message'" 
            [class.is-invalid]="isFieldInvalid('message')"
            formControlName="message"></textarea>
            @if (isFieldInvalid('message')) {
              <div class="invalid-feedback d-block">
                {{ getErrorMessage('message') }}
              </div>
            }
          </div>

          <!-- GDPR Checkbox Fix -->
          <div class="mb-4 form-check">
            <input type="checkbox" class="form-check-input" id="gdprConsent" formControlName="gdprConsent">
            <label class="form-check-label" for="gdprConsent" style="font-size: 0.9rem;">
              I have read the <a href="/privacy-policy" target="_blank">Privacy Policy</a> and agree to the processing of my data for the purpose of creating an offer.
            </label>
            
            @if (contactForm.get('gdprConsent')?.invalid && contactForm.get('gdprConsent')?.touched) {
              <div class="text-danger small d-block mt-2">
                You must agree to the privacy policy to continue.
              </div>
            }
          </div>
          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <button type="submit" class="btn btn-custom-orange" [disabled]="contactForm.invalid">
              Submit
            </button>
          </div>
        </form>
      </div>
    }
  </div>
</section>